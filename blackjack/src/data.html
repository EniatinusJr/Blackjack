<!DOCTYPE html>
<html>
    <link rel="stylesheet" href="data.css">
    <head>
        <meta charset="utf-8"&/>
        <title class="blackjack_title">Blackjack</title>
    </head>
    <body>
        <div class="center"><h1 class="title">Blackjack - simplified</h1></div>
        <div class="center">
            <div class="cards_player">
                <h1>Blackjack - simplified</h1>
                <img id="card1" src="" value="">
                <img id="card2" src="" value="">
                <img id="card3" src="" value="">
                <img id="card4" src="" value="">
                <img id="card5" src="" value="">
                <p id="card1t" class="total"></p>
                <p id="card2t" class="total"></p>
                <p id="card3t" class="total"></p>
                <p id="card4t" class="total"></p>
                <p id="card5t" class="total"></p>
                <p id="card_total" class="total"></p>                 
                <button type="button" id="newcard" class="button">Click here for 3rd card </button>
                <button type="button" id="4thcard" class="button">Click here for 4th card</button>
                <button type="button" id="5thcard" class="button">Click here for 5th card</button>
                <button type="button" id="finish" class="button">Click for no more cards</button>
            </div>
        </div>
        <div class="center">
            <div class="cards_dealer">
            <div class="center"><p class="title_dealer">Dealer</p></div>
                <div id="dealercards">

                </div>
                <p id="card1dt"></p>            
                <p id="win" class="result_dealer"></p>
                <p id="dealer_total" class="result_dealer"></p>
                <p id="win_dealer" class="result_dealer"></p>
            </div>
        </div>
        <p id="card3a"></p>
    </body>
    <script src="http://code.jquery.com/jquery-3.5.1.min.js" integrity="sha256-9/aliU8dGd2tb6OSsuzixeV4y/faTqgFtohetphbbj0=" crossorigin="anonymous"></script>
    <script>
        //variabels of cards
        var card1_value = document.getElementById("card1t");
        var card2_value = document.getElementById("card2t");
        var card3_value = document.getElementById("card3t");
        var card4_value = document.getElementById("card4t");
        var card5_value = document.getElementById("card5t");
        //variabels of dealer cards
        var card1_dealer_value = document.getElementById("card1dt");
        var card_total = document.getElementById("card_total");
        var card_total_dealer = document.getElementById("dealer_total");
        var card3_taken = false;        
        var total_player = 0;
        var win = document.getElementById("win");
        var total_dealer = 0;
        var windealer = document.getElementById("win_dealer");
        document.getElementById("card_total").innerHTML = total_player;
        document.getElementById("4thcard").disabled = true;
        document.getElementById("5thcard").disabled = true;
        $('#newcard').click(function() {
            $.getJSON('http://localhost/data.php', function(data) {
                let value = data.value;
                if(value == "QUEEN"|| value =="KING"|| value == "JACK"){
                    value = 10; 
                }
                if(value == "ACE"){
                    if(total_player + 11 <= 21){
                        value = 11;
                    }else if(total_player + 11 > 21){
                        value = 1;
                    }
                }
                document.getElementById("card3").src = data.image;
                card1_value.textContent = value;
                total_player += +value;
                card_total.innerText = total_player;
                document.getElementById("newcard").disabled = true;
                document.getElementById("4thcard").disabled = false;
                if(total_player > 21){
                    document.getElementById("newcard").disabled = true;
                    document.getElementById("4thcard").disabled = true;
                    document.getElementById("5thcard").disabled = true;
                    document.getElementById("finish").disabled = true;
                    win.innerText = "OVER 21, YOU LOSE";
                }
            });
        });
        $('#4thcard').click(function() {
            $.getJSON('http://localhost/data.php', function(data) {
                let value = data.value;
                if(value == "QUEEN"|| value =="KING"|| value == "JACK"){
                    value = 10; 
                }
                if(value == "ACE"){
                    if(total_player + 11 <= 21){
                        value = 11;
                    }else if(total_player + 11 > 21){
                        value = 1;
                    }
                }
                document.getElementById("card4").src = data.image;
                card1_value.textContent = value;
                total_player += +value;
                card_total.innerText = total_player;
                document.getElementById("newcard").disabled = true;
                document.getElementById("4thcard").disabled = true;
                document.getElementById("5thcard").disabled = false;
                if(total_player > 21){
                    document.getElementById("newcard").disabled = true;
                    document.getElementById("4thcard").disabled = true;
                    document.getElementById("5thcard").disabled = true;
                    document.getElementById("finish").disabled = true;
                    win.innerText = "OVER 21, YOU LOSE";
                }
            });
        });
        $('#5thcard').click(function() {
            $.getJSON('http://localhost/data.php', function(data) {
                let value = data.value;
                if(value == "QUEEN"|| value =="KING"|| value == "JACK"){
                    value = 10; 
                }
                if(value == "ACE"){
                    if(value == "ACE"){
                        if(total_dealer + 11 <= 21){
                            value = 11;
                        }else if(total_dealer + 11 > 21){
                            value = 1;
                        }
                    }
                }
                document.getElementById("card2d").src = data.image;
                document.getElementById("card2d").textContent = value;
                total_dealer += +value;
                card_total.innerText = total_dealer;
                while(total_dealer < 17){
                    let value = data.value;
                    if(value == "QUEEN"|| value =="KING"|| value == "JACK"){
                        value = 10; 
                    }
                    if(value == "ACE"){
                        if(total_player + 11 <= 21){
                            value = 11;
                        }else if(total_player + 11 > 21){
                            value = 1;
                        }
                    }
                    document.getElementById("card3d").src = data.image
                    document.getElementById("card3d").textContent = value; 
                    total_dealer += +value;
                    card_total_dealer.innerText = total_dealer;
                }
            });
            $.getJSON('http://localhost/data.php', function(data) {
                let value = data.value;
                if(value == "QUEEN"|| value =="KING"|| value == "JACK"){
                    value = 10; 
                }
                if(value == "ACE"){
                    if(total_player + 11 <= 21){
                        value = 11;
                    }else if(total_player + 11 > 21){
                        value = 1;
                    }
                }
                document.getElementById("card5").src = data.image;
                card1_value.textContent = value;
                total_player += +value;
                card_total.innerText = total_player;
                if(total_player < total_dealer){
                    win.innerText = "YOU LOSE";
                }
                if(total_player > total_dealer && total_player < 21){
                    win.innerText ="YOU WIN!";
                }
                if(total_player == 21 && total_player != total_dealer){
                    win.innerText = "BLACKJACK, YOU WIN!";
                }
                if(total_player > 21){
                    win.innerText = "OVER 21, YOU LOSE";
                }
                if(total_dealer > 21 && total_player < 21){
                    win.innerText = "DEALER OVER 21, YOU WIN";
                }
                if(total_dealer == total_player){
                    win.innerText = "DRAW";
                }
                document.getElementById("newcard").disabled = true;
                document.getElementById("4thcard").disabled = true;
                document.getElementById("5thcard").disabled = true;
                document.getElementById("finish").disabled = true;
            });
        });
        $.getJSON('http://localhost/data.php', function(data) {
            let value = data.value;
            if(value == "QUEEN"|| value =="KING"|| value == "JACK"){
                    value = 10; 
            }
            if(value == "ACE"){
                    if(total_player + 11 <= 21){
                        value = 11;
                    }else if(total_player + 11 > 21){
                        value = 1;
                    }
            }
            document.getElementById("card1").src = data.image;
            card1_value.textContent = value;
            total_player += +value;
            card_total.innerText = total_player;
        });
        $.getJSON('http://localhost/data.php', function(data) {
            let value = data.value;
            if(value == "QUEEN"|| value =="KING"|| value == "JACK"){
                    value = 10; 
            }
            if(value == "ACE"){
                    if(total_player + 11 <= 21){
                        value = 11;
                    }else if(total_player + 11 > 21){
                        value = 1;
                    }
            }
            document.getElementById("card2").src = data.image;
            card2_value.textContent = value;
            total_player += +value;
            card_total.innerText = total_player;
        });
        getDealerCard(0);

        function getDealerCard(min) {
            return $.getJSON('http://localhost/data.php', function(data) {
                let value = data.value;

                if(value == "QUEEN"|| value =="KING"|| value == "JACK"){
                    value = 10; 
                }

                if(value == "ACE"){
                    if(total_dealer + 11 <= 21){
                        value = 11;
                    }else if(total_dealer + 11 > 21){
                        value = 1;
                    }
                }

                let img = document.createElement("img");
                img.src = data.image;
                img.textContent = value;
                document.getElementById("dealercards").append(img)

                total_dealer += +value;
                card_total_dealer.innerText = total_dealer;
            }).then(function () {
                if(total_dealer < min) {
                    getDealerCard(min);
                }
            })
        }

        $('#finish').click(function() { 

            getDealerCard(17).then(function() {
                if(total_player < total_dealer){
                    windealer.innerText = "YOU LOSE";
                }
                if(total_player > total_dealer && total_player < 21){
                    windealer.innerText ="YOU WIN!";
                }
                if(total_player == 21 && total_player != total_dealer){
                    windealer.innerText = "BLACKJACK, YOU WIN!";
                }
                if(total_player > 21){
                    windealer.innerText = "OVER 21, YOU LOSE";
                }
                if(total_dealer > 21 && total_player < 21){
                    windealer.innerText = "DEALER OVER 21, YOU WIN";
                }
                if(total_dealer == total_player){
                    windealer.innerText = "DRAW";
                }
                document.getElementById("finish").disabled = true;
                document.getElementById("newcard").disabled = true;
                document.getElementById("4thcard").disabled = true;
                document.getElementById("5thcard").disabled = true;
            });
        
        });
    </script>
</html>